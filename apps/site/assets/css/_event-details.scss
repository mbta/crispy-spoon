@use 'sass:math';

.m-event-details {

  .c-cms__title {
    margin-top: 2.5rem;
  }

  .c-cms__title-text {
    margin-top: 0;
  }

  .m-event__date-range {
    font-size: 16px;
    font-weight: bold;
  }

  .c-paragraph {
    padding-bottom: $base-spacing * 2;
    .add-to-calendar-link {
      font-weight: 500;
    }
  }

  .m-event-section {
    padding-bottom: $base-spacing-lg;
  }

  .m-event__registration {
    display: flex;
    justify-content: space-between;
    
    &-header {
      flex: 0 1 40%;
      margin: 0;
      align-self: center;
    }

    @include media-breakpoint-down(xs) {
      display: block;
      .m-event__registration-header {
        margin-bottom: $base-spacing / 2;
      }
    }
  }

  .m-event__livestream {
    width: 100%;
    height: 56vw;
    max-height: 560px;
  }
}

$bullet-size: 32px / $font-size-base-xxl * $base-spacing; // 32px on large viewport
$separator-border: solid 1px $gray-lightest;
$agenda-row-gap: $base-spacing * .25;
$agenda-column-gap: $base-spacing * .75;

%small-grey-font {
  color: $gray;
  font-family: $font-family-base;
  font-size: $font-size-base-sm;
  font-weight: normal;
}

// adds a large round colored circle with number from counter
@mixin agenda-bullet($bg-color: $gray, $color: $white,
                     $counter, $counter-type: false) {
  &::before {
    background-color: $bg-color;
    border-radius: 50%;
    color: $color;

    @if $counter-type {
      content: counter($counter, $counter-type);
    } @else {
      content: counter($counter);
    }

    counter-increment: $counter;
    display: inline-block;
    font-weight: 700;
    height: $bullet-size;
    line-height: $bullet-size;
    text-align: center;
    width: $bullet-size;
  }
}

.m-event__agenda {
  p {
    line-height: $headings-line-height;
    margin-bottom: 0;
  }

  ol {
    list-style: none;
    padding-left: 0;

    // each agenda item lays out the content in a grid as follows
    //    --------------------------------------------
    //    | [bullet] |         [title]               |
    //    --------------------------------------------
    //    |          |  [description+ nested lists]  |
    //    |          |  height adjusts to content    |
    //    --------------------------------------------
    li {
      border-top: $separator-border;
      display: grid;
      gap: $agenda-row-gap $agenda-column-gap;
      grid-template: auto auto / $bullet-size 1fr;
      padding: $base-spacing * .75 0 $base-spacing;
    }
  }

  .agenda-topic__title {
    grid-area: 1 / 2 / 2 / 3;
    margin-top: 0;
  }

  .agenda-topic__content {
    grid-area: 2 / 2 / 3 / 3;
  }

  // top-level list
  .agenda-topics {
    counter-reset: topicCounter 0 subCounter 0;
    margin-top: $base-spacing * .75;

    > li {
      @include agenda-bullet($counter: topicCounter, $counter-type: upper-alpha);

      padding-bottom: 0;
    }
  }

  // second-level list
  .agenda-subtopics {
    margin-top: $base-spacing * .75;

    // further nested content gets styled as small muted text
    p {
      @extend %small-grey-font;
    }

    > li {
      @include agenda-bullet($bg-color: $gray-bordered-background,
      $color: $gray, $counter: subCounter);
    }

    @include media-breakpoint-down(sm) {
      // Nested items are aligned flush left with parent items in small display
      margin-left: - $bullet-size - $agenda-column-gap;
    }
  }
}
